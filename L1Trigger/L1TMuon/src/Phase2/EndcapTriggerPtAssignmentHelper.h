#ifndef L1Trigger_L1TMuon_EndcapPtAssignmentHelper_h
#define L1Trigger_L1TMuon_EndcapPtAssignmentHelper_h

#include "DataFormats/GeometryVector/interface/GlobalPoint.h"

namespace EndcapTriggerPtAssignmentHelper {

//eta partitions:1.2-1.4,1.4-1.6,1.6-1.8, 1.8-2.0, 2.0-2.2, 2.2-2.4
enum {EtaPartitions=6, Parity=4, NPt=7, NPt2=14};
//slopes_1 = [1.279, 0.6357, 1.001, 0.5252]
//slopes_2 = [0.640, .353, .555, .310]

// parity cases when considering multiple station hits
 enum class EvenOdd{Odd=0, Even=1, Invalid=2};
 enum class EvenOdd12{OddEven, OddOdd, EvenEven, EvenOdd, Invalid};
 enum class EvenOdd123{OddEvenEven, OddOddOdd, EvenEvenEven, EvenOddOdd, Invalid};

// phi_momentum = phi_position+gem-csc_bending*slope
const double BendingAngleLUT[2][2] = {
	{28.71,12.86},//even,odd for ME11
	{39.11,18.31},

};

const int PtBins[NPt] = {5,7,10,15,20,30,40};
const int PtBins2[NPt2] = {2,3,4,5,6,7,8,10,12,15,20,30,40};

int GetEtaPartition(float eta);

// equation of ellipse
float ellipse(float a, float b,float anlge, float x0, float y0, float x, float y);

float deltaYcalculation(const GlobalPoint& gp1, const GlobalPoint& gp2);

float deltadeltaYcalculation(const GlobalPoint& gp1, const GlobalPoint& gp2, const GlobalPoint& gp3, float eta, enum EvenOdd123 parity);

float Ptassign_Direction(float bending_12, float eta, int par);

float PhiMomentum(float dphi, float phi_position, int st, bool evenodd);
float PhiMomentum_Radius(float dphi, float phi_position, float radius_csc, float radius_gem);
float PhiMomentum_Xfactor(float dphi, float phi_position, float x);
float PhiMomentum_Xfactor_V2(float phi_CSC, float phi_GEM, float x);


void calculateAlphaBeta(const std::vector<float>& v,
                        const std::vector<float>& w,
                        const std::vector<float>& ev,
                        const std::vector<float>& ew,
                        const std::vector<float>& status,
                        float& alpha, float& beta);

float normalizePhi(float phi);

 EvenOdd123 getParity(EvenOdd, EvenOdd, EvenOdd, EvenOdd);


 const double PositionEpLUT[Parity][EtaPartitions][3] = {
   //prop_factor, slope, intercept
  {
    {1.279, 0.04784, 0.1122},
    {1.279, 0.65424, 0.09761},
    {0.640, 0.05527, 0.08944},
    {0.640, 0.08295, 0.1279},
    {0.640, 0.1660, 0.2158},
    {0.640, 0.4952, 0.7103},
  },
  {
    {0.6357, 0.0827, 0.2021},
    {0.6357, 0.0906, 0.1773},
    {0.3530, 0.1067, 0.1957},
    {0.3530, 0.1561, 0.2645},
    {0.3530, 0.3156, 0.4514},
    {0.3530, 0.8242, 1.0712},
  },
  {
    {1.001, 0.038, 0.008345},
    {1.001, 0.04157, 0.0617},
    {0.5550, 0.0562, 0.08417},
    {0.5550, 0.0870, 0.1426},
    {0.5550, 0.1676, 0.2198},
    {0.5550, 0.4953, 0.7272},
  },
  {
    {0.5252, 0.0739, 0.1714},
    {0.5252, 0.07838, 0.1307},
    {0.310, 0.1066, 0.2026},
    {0.310, 0.1435, 0.2118},
    {0.310, 0.2874, 0.4055},
    {0.310, 0.7625, 1.075},
  },
};

const double DirectionDeltaPhiLUT[NPt2][EtaPartitions][Parity] = {
        {//pt=2
	  //first column copied from pt=3
	  //{0.0000000,0.000000,0.000000,0.000000},
	  {0.287900,0.626400,0.543850,0.597700},
	  {0.532950,0.680300,0.761850,0.517400},
	  {0.914500,0.759600,0.853850,0.814800},
	  {0.658000,0.617900,0.641850,0.618500},
	  {0.471100,0.425400,0.391550,0.365450},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{//pt=3
	  {0.287900,0.626400,0.543850,0.597700},
	  {0.415000,0.563000,0.585000,0.501200},
	  {0.511400,0.509650,0.499950,0.515600},
	  {0.381300,0.368600,0.344725,0.347350},
	  {0.212250,0.212550,0.223250,0.187600},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{//pt=4
	  {0.384550,0.440500,0.455900,0.355550},
	  {0.271250,0.361550,0.340350,0.310800},
	  {0.245550,0.230800,0.246200,0.213450},
	  {0.180850,0.174900,0.173500,0.155175},
	  {0.118125,0.116825,0.131050,0.115250},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{
	  {0.259700,0.262583,0.268300,0.219000},
	  {0.237450,0.233740,0.226125,0.228200},
	  {0.169275,0.142050,0.168600,0.154100},
	  {0.121850,0.112550,0.111200,0.114133},
	  {0.109200,0.095475,0.106850,0.090400},
	  {0,0,0,0},
	},//pt=5
	{//pt=6
	  {0.174850,0.192933,0.201075,0.176300},
	  {0.172850,0.180200,0.179250,0.186950},
	  {0.122250,0.107850,0.114750,0.106000},
	  {0.096550,0.087550,0.091200,0.082750},
	  {0.097200,0.084850,0.094550,0.086775},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{
	  {0.162100,0.162950,0.162300,0.128350},
	  {0.162850,0.150087,0.160250,0.157750},
	  {0.106850,0.085625,0.115875,0.085800},
	  {0.085825,0.073150,0.079950,0.070550},
	  {0.094100,0.071175,0.086317,0.076400},
	  {0,0,0,0},
	},//pt=7
	{//pt=8
	  {0.124100,0.139950,0.141550,0.145500},
	  {0.127150,0.139200,0.142150,0.148850},
	  {0.091100,0.080250,0.108200,0.072750},
	  {0.069100,0.064867,0.071063,0.066000},
	  {0.090400,0.069150,0.083950,0.072850},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{
	  {0.118550,0.123264,0.119860,0.123350},
	  {0.126400,0.119917,0.120000,0.128150},
	  {0.090383,0.058650,0.082750,0.056225},
	  {0.067100,0.050583,0.065400,0.052219},
	  {0.073575,0.070983,0.080912,0.073425},
	  {0,0,0,0},
	},//pt=10
	{//pt=12
	  {0.111075,0.110450,0.108294,0.103650},
	  {0.095625,0.112417,0.109800,0.101900},
	  {0.072450,0.050633,0.073650,0.054125},
	  {0.057350,0.042405,0.058970,0.047258},
	  {0.076625,0.070025,0.080400,0.072775},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{
	  {0.081200,0.098813,0.091312,0.109500},
	  {0.090150,0.094400,0.101638,0.104400},
	  {0.063525,0.040633,0.077600,0.046200},
	  {0.055113,0.038667,0.059300,0.042813},
	  {0.072817,0.062100,0.080633,0.063250},
	  {0,0,0,0},
	},//pt=15
	{
	  {0.089625,0.093300,0.087305,0.127450},
	  {0.078250,0.091792,0.093188,0.072600},
	  {0.061750,0.034830,0.068600,0.039667},
	  {0.051025,0.034975,0.058067,0.040700},
	  {0.071850,0.055300,0.081950,0.059100},
	  {0,0,0,0},
	},//pt=20
	{
	  {0.077600,0.092469,0.087571,0.060950},
	  {0.111200,0.095543,0.091250,0.078750},
	  {0.060775,0.029388,0.061700,0.036575},
	  {0.051408,0.029807,0.053220,0.040820},
	  {0.066533,0.049900,0.073700,0.057950},
	  {0,0,0,0},
	},//pt=30
	{
	  {0.065200,0.090742,0.088683,0.035300},
	  {0.092400,0.091480,0.090338,0.093300},
	  {0.064700,0.026436,0.060800,0.039600},
	  {0.050500,0.029375,0.057660,0.039475},
	  {0.068983,0.047413,0.074288,0.055500},
	  {0,0,0,0},
	},//pt=40

};

const double DirectionDeltaPhiME21CSConlyLUT[NPt2][EtaPartitions][Parity] = {
        {//pt=2
	  //for pt=2, 1.2<eta<1.4, values copied from pt=3
	  //{0.000000,0.000000,0.000000,0.000000},
	  {0.287900,0.626400,0.543850,0.597700},
	  {0.532950,0.680300,0.761850,0.517400},
	  {0.902700,0.752100,0.908450,0.837300},
	  {0.662700,0.647000,0.654850,0.699350},
	  {0.458250,0.435000,0.421075,0.409050},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{//pt=3
	  {0.287900,0.626400,0.543850,0.597700},
	  {0.415000,0.563000,0.585000,0.501200},
	  {0.533400,0.538150,0.546450,0.576650},
	  {0.408750,0.411700,0.377550,0.365475},
	  {0.251000,0.251050,0.249900,0.241100},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{//pt=4
	  {0.384550,0.440500,0.455900,0.355550},
	  {0.271250,0.361550,0.340350,0.310800},
	  {0.275600,0.285800,0.286400,0.260950},
	  {0.227050,0.232450,0.216500,0.212850},
	  {0.188800,0.183150,0.177050,0.176000},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{
	  {0.259700,0.262583,0.268300,0.219000},
	  {0.237450,0.233740,0.226125,0.228200},
	  {0.218550,0.210550,0.254650,0.196600},
	  {0.174675,0.170100,0.164900,0.167400},
	  {0.154950,0.151975,0.169700,0.164800},
	  {0.000000,0.000000,0.000000,0.000000},
	},//pt=5
	{//pt=6
	  {0.174850,0.192933,0.201075,0.176300},
	  {0.172850,0.180200,0.179250,0.186950},
	  {0.163250,0.160175,0.181750,0.170500},
	  {0.148300,0.141025,0.153467,0.144417},
	  {0.144200,0.137350,0.150100,0.160050},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{
	  {0.162100,0.162950,0.162300,0.128350},
	  {0.162850,0.150087,0.160250,0.157750},
	  {0.150350,0.147750,0.158250,0.127800},
	  {0.149650,0.140433,0.139200,0.137700},
	  {0.142600,0.149250,0.139450,0.147900},
	  {0.000000,0.000000,0.000000,0.000000},
	},//pt=7
	{//pt=8
	  {0.124100,0.139950,0.141550,0.145500},
	  {0.127150,0.139200,0.142150,0.148850},
	  {0.152150,0.137000,0.177700,0.130250},
	  {0.119600,0.152550,0.138250,0.139500},
	  {0.162400,0.167075,0.151725,0.158350},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{
	  {0.118550,0.123264,0.119860,0.123350},
	  {0.126400,0.119917,0.120000,0.128150},
	  {0.150150,0.136650,0.152750,0.131400},
	  {0.135300,0.144750,0.137625,0.142750},
	  {0.141075,0.148725,0.167825,0.171700},
	  {0.000000,0.000000,0.000000,0.000000},
	},//pt=10
	{//pt=12
	  {0.095625,0.112417,0.109800,0.101900},
	  {0.072450,0.050633,0.073650,0.054125},
	  {0.137450,0.137900,0.161150,0.169250},
	  {0.132950,0.146483,0.138617,0.157550},
	  {0.162500,0.152100,0.165500,0.168525},
	  {0.000000,0.000000,0.000000,0.000000},
	},
	{
	  {0.081200,0.098813,0.091312,0.109500},
	  {0.090150,0.094400,0.101638,0.104400},
	  {0.159550,0.149700,0.162150,0.152200},
	  {0.145242,0.146500,0.153650,0.146313},
	  {0.150725,0.153600,0.163400,0.163000},
	  {0.000000,0.000000,0.000000,0.000000},
	},//pt=15
	{
	  {0.089625,0.093300,0.087305,0.127450},
	  {0.078250,0.091792,0.093188,0.072600},
	  {0.151250,0.144075,0.158850,0.144500},
	  {0.149550,0.143113,0.150200,0.148200},
	  {0.159200,0.168300,0.160860,0.154550},
	  {0.000000,0.000000,0.000000,0.000000},
	},//pt=20
	{
	  {0.077600,0.092469,0.087571,0.060950},
	  {0.111200,0.095543,0.091250,0.078750},
	  {0.191550,0.143775,0.151233,0.155575},
	  {0.153225,0.155150,0.148200,0.161867},
	  {0.156100,0.169350,0.156625,0.171950},
	  {0.000000,0.000000,0.000000,0.000000},
	},//pt=30
	{
	  {0.065200,0.090742,0.088683,0.035300},
	  {0.092400,0.091480,0.090338,0.093300},
	  {0.158700,0.132275,0.145300,0.157800},
	  {0.154800,0.159500,0.147267,0.156475},
	  {0.169500,0.174650,0.169883,0.170050},
	  {0.000000,0.000000,0.000000,0.000000},
	},//pt=40
};


const double PositionPtDDYLUT[NPt2][EtaPartitions][Parity] = {
        {//pt=2
	  {28.236000,21.296000,36.365000,21.208000},
	  {16.918000,19.712000,38.134000,11.136000},
	  {39.262000,29.200000,39.080000,33.882000},
	  {31.724000,22.982000,33.506000,24.444000},
	  {18.762000,10.956000,19.028000,11.275000},
	  {7.089000,4.435333,7.274000,4.188000},
	},
	{//pt=3
	  {28.236000,21.296000,36.365000,21.208000},
	  {20.400000,16.287000,31.386000,15.448000},
	  {27.474000,17.744000,29.412000,19.044000},
	  {20.326000,11.340000,19.606000,11.526000},
	  {8.020000,5.321000,8.230000,5.064000},
	  {3.566000,2.274000,3.950000,2.270000},
	},
	{//pt=4
	  {16.524000,15.660000,29.768667,12.102000},
	  {13.705000,9.467333,17.598000,8.552000},
	  {13.694000,7.896000,13.996000,7.758000},
	  {9.326000,5.396000,9.610000,5.307000},
	  {4.576667,2.706000,4.822000,2.720000},
	  {2.391000,1.304000,2.464000,1.440333},
	},
	{
	  {12.464000,7.834000,16.116000,8.560000},
	  {9.038000,5.218286,10.590000,5.328000},
	  {8.881000,4.782000,8.984000,5.204000},
	  {6.247000,3.567333,6.116000,3.548000},
	  {3.288000,1.866000,3.397000,1.878667},
	  {1.784500,1.013333,1.778000,1.080000},
	},//pt=5
	{//pt=6
	  {8.394000,5.178857,10.665200,5.652000},
	  {7.054000,3.753600,8.065000,3.749000},
	  {6.490000,3.747000,6.030000,3.720000},
	  {4.600500,2.605500,4.805333,2.722000},
	  {2.532000,1.597000,2.488000,1.464400},
	  {1.522000,0.821429,1.356500,0.797333},
	},
	{
	  {7.084000,3.957500,8.190000,4.256000},
	  {5.574000,3.079000,6.290000,3.430000},
	  {4.814000,3.070000,5.270000,3.090667},
	  {3.631500,2.177333,3.670571,2.116000},
	  {2.082000,1.216000,2.039500,1.215200},
	  {1.273000,0.777333,1.206000,0.786800},
	},//pt=7
	{//pt=8
	  {5.824000,3.246333,6.704400,3.720000},
	  {4.763000,2.517538,5.143000,2.734000},
	  {4.232000,2.493333,4.228000,2.575000},
	  {3.141333,1.881000,3.016667,1.940000},
	  {1.856571,1.069429,1.794000,1.102800},
	  {1.005429,0.606000,1.021000,0.661500},
	},
	{
	  {4.682000,2.461000,4.933333,3.098000},
	  {4.116000,1.960769,3.946667,2.186000},
	  {3.406000,1.913000,3.336667,1.916000},
	  {2.375200,1.476250,2.387000,1.407778},
	  {1.418833,0.849800,1.411778,0.898375},
	  {0.839385,0.550857,0.862667,0.547200},
	},//pt=10
	{//pt=12
	  {3.503000,1.958222,3.914000,1.906000},
	  {3.250000,1.630435,3.239692,1.590667},
	  {2.699000,1.595200,2.666000,1.652500},
	  {1.988444,1.213167,1.950571,1.174000},
	  {1.187692,0.733467,1.203333,0.749273},
	  {0.765846,0.482125,0.713429,0.467200},
	},
	{
	  {2.876000,1.508095,3.002500,1.444000},
	  {2.616000,1.288632,2.555125,1.596000},
	  {2.087333,1.272000,2.011000,1.282667},
	  {1.576857,0.975714,1.630400,1.013000},
	  {1.002250,0.682667,1.002769,0.649231},
	  {0.616375,0.416083,0.591294,0.420462},
	},//pt=15
	{
	  {2.265000,1.168000,2.208600,1.242000},
	  {1.990000,0.982500,1.889818,1.124000},
	  {1.670000,1.016500,1.654000,1.086667},
	  {1.264200,0.836769,1.248500,0.799714},
	  {0.844800,0.597750,0.851200,0.572750},
	  {0.519895,0.392500,0.499111,0.371143},
	},//pt=20
	{
	  {1.624000,0.896636,1.507692,0.958000},
	  {1.454000,0.781857,1.330000,0.870000},
	  {1.287333,0.785500,1.304667,0.772286},
	  {0.926000,0.690500,0.911478,0.658222},
	  {0.686462,0.480667,0.667556,0.472111},
	  {0.472571,0.352818,0.447520,0.335000},
	},//pt=30
	{
	  {1.108000,0.736800,1.277700,0.612000},
	  {1.078000,0.646783,1.086267,0.452000},
	  {1.362667,0.675778,1.046000,0.712000},
	  {0.788421,0.588889,0.779500,0.567250},
	  {0.629667,0.478250,0.577429,0.465714},
	  {0.431200,0.355692,0.419048,0.328706},
	},//pt=40

};



//pt,npar,eta->a,b,anlge,x0,y0
//pt:5,7,10,15,20,30,40:
const double HybridDDYAndDeltaPhiLUT[NPt][EtaPartitions][Parity][5] = {

	{//npt=0, pt=5
	    {
		{12.900000,0.217517,0.000000,0.000000,-0.000000},
		{4.500000,0.283008,0.000000,0.000000,-0.000000},
		{9.000000,0.320000,0.000000,0.309710,-0.004582},
		{5.100000,0.219589,0.000000,0.641146,-0.019085},
	    },
	    {
		{8.700000,0.292285,0.000000,0.000000,-0.000000},
		{3.000000,0.288281,0.000000,0.493732,-0.016262},
		{6.900000,0.600000,0.000000,0.000000,-0.000000},
		{3.900000,0.650000,0.000000,0.000000,-0.000000},
	    },
	    {
		{8.100000,0.525372,0.069813,0.000000,-0.000000},
		{3.900000,0.344839,0.069813,0.000000,-0.000000},
		{6.300000,0.377383,0.034907,-0.000000,0.000000},
		{5.500000,0.212319,0.034907,-0.000000,-0.000000},
	    },
	    {
		{5.700000,0.359500,0.069813,0.000000,-0.000000},
		{3.300000,0.145683,0.034907,0.000000,-0.000000},
		{4.500000,0.276855,0.000000,-0.000000,-0.000000},
		{3.100000,0.157624,0.034907,0.000000,0.000000},
	     },
	     {
		{2.900000,0.320423,0.069813,0.000000,-0.000000},
		{1.700000,0.138428,0.000000,-0.000000,0.000000},
		{2.300000,0.382812,0.000000,-0.000000,-0.000000},
		{1.700000,0.234375,0.000000,0.000000,-0.000000},
	     },
	},
	{//pt=7
	    {
		{6.300000,0.287500,0.000000,0.000000,-0.000000},
		{3.000000,0.400000,0.000000,0.000000,-0.000000},
		{6.300000,0.307617,0.000000,0.000000,-0.000000},
		{3.900000,0.210782,0.000000,0.000000,-0.000000},
	    },
	    {
		{6.300000,0.198810,0.000000,0.000000,-0.000000},
		{2.700000,0.275000,0.000000,0.000000,-0.000000},
		{5.700000,0.269617,0.000000,0.000000,-0.000000},
		{2.700000,0.550000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.700000,0.500000,0.034907,0.000000,0.000000},
		{3.900000,0.233010,0.069813,0.000000,-0.000000},
		{3.900000,0.347900,0.034907,-0.000000,-0.000000},
		{2.700000,0.238037,0.034907,-0.000000,-0.000000},
	    },
	    {
		{3.700000,0.204223,0.034907,0.000000,0.000000},
		{1.900000,0.125000,0.000000,0.000000,-0.000000},
		{2.900000,0.406250,0.034907,-0.000000,-0.000000},
		{2.100000,0.132812,0.000000,0.000000,-0.000000},
	    },
	    {
		{2.500000,0.303745,0.104720,0.000000,-0.000000},
		{1.300000,0.179688,0.000000,-0.000000,0.000000},
		{2.300000,0.218018,0.000000,-0.000000,-0.000000},
		{1.500000,0.328125,0.104720,0.000000,-0.000000},
	    },
	},
	{//pt=10
	    {
		{4.500000,0.300000,0.000000,0.000000,-0.000000},
		{2.100000,0.400000,0.000000,0.000000,-0.000000},
		{4.200000,0.400000,0.000000,0.000000,-0.000000},
		{2.400000,0.400000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.300000,0.250000,0.000000,0.157426,-0.001423},
		{1.800000,0.275000,0.000000,0.163588,-0.005329},
		{3.900000,0.220313,0.000000,0.000000,-0.000000},
		{2.100000,0.300000,0.000000,0.000000,-0.000000},
	    },
	    {
		{6.300000,0.324725,0.104720,0.000000,-0.000000},
		{1.900000,0.109375,0.000000,-0.000000,0.000000},
		{3.500000,0.346680,0.034907,0.000000,-0.000000},
		{2.500000,0.115156,0.034907,-0.000000,-0.000000},
	    },
	    {
		{2.300000,0.312500,0.034907,0.000000,-0.000000},
		{1.700000,0.064453,0.000000,0.000000,-0.000000},
		{2.500000,0.140625,0.000000,-0.000000,-0.000000},
		{1.700000,0.109375,0.000000,-0.000000,0.000000},
	    },
	    {
		{1.900000,0.281250,0.069813,0.000000,-0.000000},
		{1.300000,0.128906,0.000000,-0.000000,-0.000000},
		{2.100000,0.317017,0.139626,-0.000000,-0.000000},
		{1.300000,0.164062,0.034907,0.000000,-0.000000},
	    },
	},
	{//pt=15
	    {
		{3.300000,0.250000,0.000000,0.000000,-0.000000},
		{1.500000,0.400000,0.000000,0.000000,-0.000000},
		{3.000000,0.193750,0.000000,0.000000,-0.000000},
		{2.400000,0.135352,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.000000,0.175000,0.000000,0.000000,-0.000000},
		{1.200000,0.225000,0.000000,0.244104,-0.007649},
		{2.400000,0.275000,0.000000,0.252971,-0.004051},
		{2.100000,0.169336,0.000000,0.026777,-0.000950},
	    },
	    {
		{19.500000,0.205983,0.104720,0.000000,-0.000000},
		{1.500000,0.078125,0.000000,0.000000,0.000000},
		{2.700000,0.245987,0.069813,0.000000,-0.000000},
		{1.700000,0.593750,0.174533,-0.000000,-0.000000},
	    },
	    {
		{2.100000,0.187500,0.069813,0.000000,0.000000},
		{1.300000,0.078125,0.034907,0.000000,-0.000000},
		{1.900000,0.101562,0.000000,-0.000000,-0.000000},
		{1.500000,0.281250,0.139626,0.000000,0.000000},
	    },
	    {
		{2.100000,0.179087,0.104720,-0.000000,-0.000000},
		{1.100000,0.132812,0.000000,-0.000000,0.000000},
		{1.700000,0.078125,0.000000,-0.000000,-0.000000},
		{0.900000,0.274292,0.139626,0.000000,-0.000000},
	    },
	},
	{//pt=20
	    {
		{2.400000,0.400000,0.000000,0.151353,-0.008018},
		{1.200000,0.450000,0.000000,0.000000,-0.000000},
		{2.400000,0.175000,0.000000,0.000000,-0.000000},
		{1.500000,0.112500,0.000000,0.037791,-0.001752},
	    },
	    {
		{3.300000,0.135360,0.000000,0.223976,-0.001455},
		{0.900000,0.218750,0.000000,0.197348,-0.005743},
		{1.800000,0.200000,0.000000,0.197683,-0.002836},
		{1.500000,0.550000,0.000000,0.176672,-0.004753},
	    },
	    {
		{1.900000,0.500000,0.000000,0.000000,-0.000000},
		{2.500000,0.308792,0.174533,-0.000000,0.000000},
		{2.100000,0.187500,0.069813,0.000000,0.000000},
		{1.500000,0.171875,0.034907,-0.000000,-0.000000},
	    },
	    {
		{2.100000,0.078125,0.034907,-0.000000,0.000000},
		{1.300000,0.070312,0.034907,0.000000,-0.000000},
		{1.700000,0.109375,0.000000,0.000000,-0.000000},
		{1.100000,0.171875,0.104720,0.000000,0.000000},
	    },
	    {
		{1.500000,0.207764,0.104720,-0.000000,-0.000000},
		{1.100000,0.101074,0.034907,0.000000,0.000000},
		{1.300000,0.210938,0.104720,-0.000000,-0.000000},
		{0.900000,0.117188,0.034907,0.000000,-0.000000},
	    },
	},
	{//pt=30
	    {
		{2.100000,0.400000,0.000000,0.170191,-0.011848},
		{0.900000,0.256250,0.000000,0.169226,-0.006358},
		{1.500000,0.225000,0.000000,0.151479,-0.001942},
		{4.800000,0.650000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.000000,0.106250,0.000000,0.000000,-0.000000},
		{0.900000,0.225000,0.000000,0.159882,-0.000736},
		{1.500000,0.187500,0.000000,0.034574,-0.000521},
		{0.900000,0.175000,0.000000,0.000000,-0.000000},
	    },
	    {
		{1.500000,0.500000,0.000000,0.000000,-0.000000},
		{2.100000,0.062500,0.069813,0.000000,0.000000},
		{2.300000,0.070312,0.000000,-0.000000,-0.000000},
		{2.700000,0.187500,0.244346,-0.000000,-0.000000},
	    },
	    {
		{1.500000,0.070312,0.034907,-0.000000,0.000000},
		{1.100000,0.126343,0.069813,-0.000000,-0.000000},
		{2.300000,0.164795,0.139626,-0.000000,-0.000000},
		{1.100000,0.148438,0.139626,-0.000000,0.000000},
	    },
	    {
		{2.300000,0.119601,0.139626,-0.000000,-0.000000},
		{0.700000,0.937500,0.000000,-0.000000,-0.000000},
		{1.300000,0.203125,0.139626,-0.000000,-0.000000},
		{0.500000,0.687500,0.069813,-0.000000,-0.000000},
	    },
	},
	{//pt=40
	    {
		{1.800000,0.056250,0.000000,0.728845,-0.035947},
		{0.900000,0.137500,0.000000,0.117756,-0.008075},
		{1.200000,0.231250,0.000000,0.259540,-0.006759},
		{0.600000,0.125000,0.000000,0.123788,0.001463},
	    },
	    {
		{0.900000,0.400000,0.000000,-0.000000,-0.000000},
		{2.100000,0.372070,0.000000,0.169291,0.005314},
		{0.900000,0.200000,0.000000,0.252559,-0.001208},
		{0.600000,0.150000,0.000000,0.104395,0.019780},
	    },
	    {
		{1.100000,0.500000,0.000000,0.000000,0.000000},
		{5.500000,0.152817,0.034907,0.000000,0.000000},
		{3.500000,0.076172,0.034907,-0.000000,0.000000},
		{0.900000,0.125000,0.000000,0.000000,0.000000},
	    },
	    {
		{0.700000,0.062500,0.000000,-0.000000,0.000000},
		{0.900000,0.062012,0.069813,-0.000000,-0.000000},
		{4.900000,0.125000,0.104720,-0.000000,-0.000000},
		{4.100000,0.124362,0.034907,-0.000000,0.000000},
	    },
	    {
		{1.300000,0.250000,0.174533,-0.000000,-0.000000},
		{0.300000,0.039062,0.139626,-0.000000,0.000000},
		{1.300000,0.093750,0.104720,-0.000000,-0.000000},
		{0.500000,0.257812,0.349066,-0.000000,-0.000000},
	    },
	},
};



//pt:5,7,10,15,20,30,40;
const double HybridDDYAndDeltaPhiLUTME21CSConly[NPt][EtaPartitions][Parity][5] = {

	{//npt=0, pt=5
	    {
		{12.900000,0.217517,0.000000,0.000000,-0.000000},
		{4.500000,0.283008,0.000000,0.000000,-0.000000},
		{9.000000,0.320000,0.000000,0.309710,-0.004582},
		{5.100000,0.219589,0.000000,0.641146,-0.019085},
	    },
	    {
		{8.700000,0.292285,0.000000,0.000000,-0.000000},
		{3.000000,0.288281,0.000000,0.493732,-0.016262},
		{6.900000,0.600000,0.000000,0.000000,-0.000000},
		{3.900000,0.650000,0.000000,0.000000,-0.000000},
	    },
	    {
		{6.900000,0.628871,0.069813,0.000000,-0.000000},
		{3.500000,0.316269,0.034907,0.000000,-0.000000},
		{6.100000,0.807848,0.069813,-0.000000,-0.000000},
		{4.900000,0.260959,0.034907,-0.000000,0.000000},
	    },
	    {
		{3.900000,0.625000,0.034907,0.000000,-0.000000},
		{2.300000,0.906250,0.034907,0.000000,0.000000},
		{4.100000,0.773438,0.000000,-0.000000,-0.000000},
		{3.700000,0.961304,0.349066,0.000000,-0.000000},
	    },
	    {
		{2.500000,0.492310,0.069813,0.000000,-0.000000},
		{1.500000,0.664062,0.244346,-0.000000,-0.000000},
		{2.300000,0.484375,0.000000,-0.000000,0.000000},
		{1.700000,0.421875,0.000000,0.000000,-0.000000},
	    },
	},
	{//pt=7
	    {
		{6.300000,0.287500,0.000000,0.000000,-0.000000},
		{3.000000,0.400000,0.000000,0.000000,-0.000000},
		{6.300000,0.307617,0.000000,0.000000,-0.000000},
		{3.900000,0.210782,0.000000,0.000000,-0.000000},
	    },
	    {
		{6.300000,0.198810,0.000000,0.000000,-0.000000},
		{2.700000,0.275000,0.000000,0.000000,-0.000000},
		{5.700000,0.269617,0.000000,0.000000,-0.000000},
		{2.700000,0.550000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.700000,0.562500,0.000000,0.000000,-0.000000},
		{2.500000,0.296875,0.000000,0.000000,-0.000000},
		{3.900000,0.427734,0.000000,-0.000000,-0.000000},
		{2.500000,0.796875,0.139626,-0.000000,0.000000},
	    },
	    {
		{3.100000,0.453125,0.000000,0.000000,-0.000000},
		{1.900000,0.656250,0.139626,0.000000,0.000000},
		{2.900000,0.625000,0.069813,-0.000000,-0.000000},
		{2.100000,0.890625,0.244346,0.000000,-0.000000},
	    },
	    {
		{1.900000,0.437500,0.000000,0.000000,-0.000000},
		{1.300000,0.375000,0.104720,-0.000000,-0.000000},
		{2.100000,0.500000,0.000000,-0.000000,0.000000},
		{1.500000,0.421875,0.069813,0.000000,-0.000000},
	    },
	},
	{//pt=10
	    {
		{4.500000,0.300000,0.000000,0.000000,-0.000000},
		{2.100000,0.400000,0.000000,0.000000,-0.000000},
		{4.200000,0.400000,0.000000,0.000000,-0.000000},
		{2.400000,0.400000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.300000,0.250000,0.000000,0.157426,-0.001423},
		{1.800000,0.275000,0.000000,0.163588,-0.005329},
		{3.900000,0.220313,0.000000,0.000000,-0.000000},
		{2.100000,0.300000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.500000,0.546328,0.069813,0.000000,-0.000000},
		{1.900000,0.343750,0.034907,-0.000000,-0.000000},
		{3.700000,0.431252,0.034907,0.000000,-0.000000},
		{1.900000,0.976562,0.349066,-0.000000,0.000000},
	    },
	    {
		{2.500000,0.465454,0.069813,0.000000,-0.000000},
		{1.700000,0.288696,0.069813,0.000000,0.000000},
		{2.500000,0.468750,0.069813,-0.000000,-0.000000},
		{1.700000,0.609375,0.174533,-0.000000,-0.000000},
	    },
	    {
		{1.700000,0.468750,0.000000,0.000000,-0.000000},
		{1.100000,0.367188,0.034907,-0.000000,-0.000000},
		{1.700000,0.687500,0.000000,-0.000000,0.000000},
		{1.300000,0.562500,0.349066,0.000000,-0.000000},
	    },
	},
	{//pt=15
	    {
		{3.300000,0.250000,0.000000,0.000000,-0.000000},
		{1.500000,0.400000,0.000000,0.000000,-0.000000},
		{3.000000,0.193750,0.000000,0.000000,-0.000000},
		{2.400000,0.135352,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.000000,0.175000,0.000000,0.000000,-0.000000},
		{1.200000,0.225000,0.000000,0.244104,-0.007649},
		{2.400000,0.275000,0.000000,0.252971,-0.004051},
		{2.100000,0.169336,0.000000,0.026777,-0.000950},
	    },
	    {
		{2.500000,0.437500,0.034907,0.000000,-0.000000},
		{1.500000,0.250000,0.000000,-0.000000,-0.000000},
		{2.300000,0.500000,0.000000,0.000000,-0.000000},
		{1.700000,0.875000,0.244346,-0.000000,-0.000000},
	    },
	    {
		{2.100000,0.687500,0.244346,0.000000,-0.000000},
		{1.300000,0.578125,0.349066,0.000000,0.000000},
		{1.900000,0.781250,0.244346,-0.000000,-0.000000},
		{1.700000,0.578979,0.349066,0.000000,-0.000000},
	    },
	    {
		{1.500000,0.351562,0.034907,-0.000000,-0.000000},
		{1.100000,0.281250,0.034907,-0.000000,-0.000000},
		{1.500000,0.218750,0.000000,-0.000000,0.000000},
		{0.900000,0.437500,0.000000,0.000000,-0.000000},
	    },
	},
	{//pt=20
	    {
		{2.400000,0.400000,0.000000,0.151353,-0.008018},
		{1.200000,0.450000,0.000000,0.000000,-0.000000},
		{2.400000,0.175000,0.000000,0.000000,-0.000000},
		{1.500000,0.112500,0.000000,0.037791,-0.001752},
	    },
	    {
		{3.300000,0.135360,0.000000,0.223976,-0.001455},
		{0.900000,0.218750,0.000000,0.197348,-0.005743},
		{1.800000,0.200000,0.000000,0.197683,-0.002836},
		{1.500000,0.550000,0.000000,0.176672,-0.004753},
	    },
	    {
		{1.900000,0.500000,0.000000,0.000000,-0.000000},
		{1.700000,0.781250,0.349066,-0.000000,-0.000000},
		{2.100000,0.250000,0.000000,0.000000,-0.000000},
		{1.500000,0.531250,0.139626,-0.000000,0.000000},
	    },
	    {
		{1.900000,0.296875,0.069813,-0.000000,-0.000000},
		{1.300000,0.226562,0.000000,0.000000,0.000000},
		{1.700000,0.468750,0.139626,0.000000,-0.000000},
		{0.900000,0.992188,0.244346,0.000000,-0.000000},
	    },
	    {
		{1.100000,0.500000,0.000000,-0.000000,0.000000},
		{0.900000,0.406250,0.139626,0.000000,-0.000000},
		{1.300000,0.398438,0.174533,-0.000000,0.000000},
		{0.700000,0.726562,0.104720,0.000000,-0.000000},
	    },
	},
	{//pt=30
	    {
		{2.100000,0.400000,0.000000,0.170191,-0.011848},
		{0.900000,0.256250,0.000000,0.169226,-0.006358},
		{1.500000,0.225000,0.000000,0.151479,-0.001942},
		{4.800000,0.650000,0.000000,0.000000,-0.000000},
	    },
	    {
		{3.000000,0.106250,0.000000,0.000000,-0.000000},
		{0.900000,0.225000,0.000000,0.159882,-0.000736},
		{1.500000,0.187500,0.000000,0.034574,-0.000521},
		{0.900000,0.175000,0.000000,0.000000,-0.000000},
	    },
	    {
		{1.500000,0.500000,0.000000,0.000000,-0.000000},
		{2.100000,0.312500,0.244346,0.000000,-0.000000},
		{3.300000,0.242539,0.139626,-0.000000,-0.000000},
		{2.900000,0.546875,0.349066,-0.000000,0.000000},
	    },
	    {
		{1.300000,0.234375,0.000000,-0.000000,-0.000000},
		{1.100000,0.496094,0.349066,-0.000000,0.000000},
		{1.500000,0.406250,0.244346,-0.000000,-0.000000},
		{1.100000,0.328125,0.244346,-0.000000,-0.000000},
	    },
	    {
		{1.700000,0.519954,0.349066,-0.000000,-0.000000},
		{0.900000,0.984375,0.000000,-0.000000,-0.000000},
		{1.300000,0.398438,0.349066,-0.000000,-0.000000},
		{0.500000,0.703125,0.104720,-0.000000,-0.000000},
	    },
	},
	{//pt=40
	    {
		{1.800000,0.056250,0.000000,0.728845,-0.035947},
		{0.900000,0.137500,0.000000,0.117756,-0.008075},
		{1.200000,0.231250,0.000000,0.259540,-0.006759},
		{0.600000,0.125000,0.000000,0.123788,0.001463},
	    },
	    {
		{0.900000,0.400000,0.000000,-0.000000,-0.000000},
		{2.100000,0.372070,0.000000,0.169291,0.005314},
		{0.900000,0.200000,0.000000,0.252559,-0.001208},
		{0.600000,0.150000,0.000000,0.104395,0.019780},
	    },
	    {
		{0.900000,0.081250,0.000000,0.068694,0.025926},
		{5.400000,0.750000,0.000000,-0.061004,0.031152},
		{3.300000,0.700000,0.000000,0.384107,0.039390},
		{0.600000,0.100000,0.000000,0.026198,-0.002023},
	    },
	    {
		{0.600000,0.206250,0.000000,0.134839,-0.009503},
		{0.600000,0.193750,0.000000,0.056518,-0.008958},
		{30.000000,0.800000,0.000000,0.000000,0.000000},
		{3.600000,0.090454,0.000000,-0.021668,0.015141},
	    },
	    {
		{1.200000,0.518750,0.000000,0.145961,-0.015750},
		{0.600000,0.081250,0.000000,0.031866,-0.006846},
		{1.200000,0.287500,0.000000,0.082988,0.005280},
		{0.600000,0.562500,0.000000,0.000000,-0.000000},
	    },
	},

};



//updated the LUT, by Tao, 20160724
const double DirectionEpLUT[Parity][EtaPartitions][2]={
    	       {{2.907, 5.906},
		{2.600, 5.191},
		{4.405, 8.809},
		{7.332, 14.478},
		{8.747, 12.265},
		//{11.02, 14.84},
	       },
	       {{2.409, 5.198},
		{2.467, 4.397},
		{4.411, 8.621},
		{7.333, 14.552},
		{8.955, 13.093},
		//{10.34, 11.02},
	       },
	       {{2.301, 4.929},
		{2.230, 3.111},
		{5.288, 10.987},
		{8.242, 16.698},
		{9.213, 13.111},
		//{11.23, 13.44},
	       },
	       {{2.401, 4.758},
		{2.383, 3.782},
		{5.222, 10.769},
		{8.292, 16.955},
		{9.074, 12.083},
		//{11.83, 17.66},
	       },
	};

}

#endif
